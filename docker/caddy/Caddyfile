{
    email {$ACME_EMAIL}
}

# Import local overrides if they exist (glob pattern makes it optional)
import Caddyfile.local*

{$APP_DOMAIN:localhost} {
    encode gzip zstd

    # phpMyAdmin at /pma with Basic Auth
    # handle_path automatically strips /pma prefix before proxying
    handle_path /pma* {
        basicauth {
            admin {$PMA_BCRYPT_HASH}
        }
        reverse_proxy phpmyadmin:80
    }

    # Main app traffic (handles everything else)
    handle {
        reverse_proxy nginx:80
    }
}
